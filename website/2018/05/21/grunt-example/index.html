<!--
 * @Author: Leland
 * @Date: 2019-12-27 15:59:00
 * @Description: Description
 -->
<!doctype html>
<html>

    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui" />
        <title>使用 Gruntjs 压缩合并前端静态资源（图片、JavaScript 和 CSS ）</title>
        <link href="/css/style.css" rel="stylesheet" />
        <meta name="description" content="使用 Gruntjs 压缩合并前端静态资源（图片、JavaScript 和 CSS ）">
    </head>

    <body>
        <div>
        <div>
        <header class="header">
            <div class="container header-wrap">
                <h1 class="site-name">
                    <a href="/">
                        首页
                    </a>
                </h1>
                <ul class="nav">
                    {{navs}}
                </ul>
            </div>
        </header>
        </div>
        <div class="container main">
        <div class="page-body">
            <div class="markdown-body">
                <h1>使用 Gruntjs 压缩合并前端静态资源（图片、JavaScript 和 CSS ）</h1>
<h3>安装环境：</h3>
<h4>Nodejs：https://nodejs.org/en/ 安装最新版本</h4>
<h4>进入目录（cd projectName）</h4>
<h4>新建package.json 内容如下：</h4>
<pre><code class="language-js">{
  &quot;name&quot;: &quot;my-project-name&quot;,
  &quot;version&quot;: &quot;0.1.0&quot;,
  &quot;devDependencies&quot;: {
    &quot;grunt&quot;: &quot;^0.4.5&quot;,
    &quot;grunt-contrib-concat&quot;: &quot;^1.0.0&quot;,
    &quot;grunt-contrib-cssmin&quot;: &quot;^0.12.3&quot;,
    &quot;grunt-contrib-imagemin&quot;: &quot;^1.0.0&quot;,
    &quot;grunt-contrib-jshint&quot;: &quot;^0.12.0&quot;,
    &quot;grunt-contrib-nodeunit&quot;: &quot;~0.4.1&quot;,
    &quot;grunt-contrib-uglify&quot;: &quot;^0.5.1&quot;
  }
}
</code></pre>
<h4>命令行执行 <code>npm install </code></h4>
<h4>接着安装grunt命令行工具 <code> npm install -g grunt-cli</code></h4>
<h4>接着配置Gruntfile.js文件</h4>
<pre><code class="language-js">module.exports = function(grunt) {

    grunt.initConfig({

        //our JSHint options
        jshint: {
            all: ['main.js'] //files to lint
        },
        //our concat options
        concat: {
            options: {
                separator: ';' //separates scripts
            },
            dist: {
                src: ['html5/javascripts/jquery.min.js', 'html5/javascripts/dialog.js', 'html5/javascripts/utils.js','html5/javascripts/limit.js','html5/javascripts/pageScrollAjax.js','html5/javascripts/app.js','html5/javascripts/tabs.js','html5/javascripts/swiper.min.js'], //需要合并的文件，注意顺序
                dest: 'html5/javascripts/build.js' //合并后生成的文件
            }
        },

        //压缩js
        uglify: {
            js: {
                files: {
                    'html5/javascripts/build.min.js': ['html5/javascripts/build.js'] //合并后压缩
                }
            }
        },
        cssmin: {
         options: {
             keepSpecialComments: 0
         },
         compress: {
             files: { // css压缩app.min.css为压缩后生成的文件,后面的数组为需要合并压缩的文件（同样注意顺序）
                 'html5/stylesheets/app.min.css': [
                     &quot;html5/stylesheets/common.css&quot;,
                     &quot;html5/stylesheets/swiper.min.css&quot;,
                     &quot;html5/stylesheets/dialog.css&quot;,
                     &quot;html5/stylesheets/app.css&quot;,
                     &quot;html5/stylesheets/new.css&quot;,
                     &quot;html5/stylesheets/app-type.css&quot;
                 ]
             }
         }
     },

     imagemin: {
            /* 压缩图片大小 */
            dist: {
                options: {
                    optimizationLevel: 3 //定义 PNG 图片优化水平
                },
                files: [{
                    expand: true,
                    cwd: 'images/html5',
                    src: ['**/*.{png,jpg,jpeg}'], // 优化 img 目录下所有 png/jpg/jpeg 图片
                    dest: 'images/html5' // 优化后的图片保存位置，覆盖旧图片，并且不作提示（建议新建一个目录）
                }]
            }
        }

    });
    //加载任务
    grunt.loadNpmTasks('grunt-contrib-jshint');
    grunt.loadNpmTasks('grunt-contrib-concat');
    grunt.loadNpmTasks('grunt-contrib-uglify');
    grunt.loadNpmTasks('grunt-contrib-cssmin');
    grunt.loadNpmTasks('grunt-contrib-imagemin');

    // default tasks to run
    // grunt.registerTask('default', ['jshint', 'concat', 'uglify']);
    grunt.registerTask('development', ['jshint']);
    grunt.registerTask('production', ['jshint', 'concat', 'uglify','imagemin','cssmin']);
  }


</code></pre>
<p>1.检查js语法<code>grunt jshint</code></p>
<p>2.合并js <code>grunt concat</code></p>
<p>3.压缩js<code>grunt uglify</code></p>
<p>4.压缩css<code>grunt imagemin</code></p>
<p>5.压缩图片<code>grunt cssmin</code></p>
<p>（注意js压缩之前要先合并，也就是第一步和第二部有先后顺序）</p>
<p>6.批量处理 <code>grunt production</code></p>
<h3>相关链接：</h3>
<h4>Gruntjs 批量无损压缩图片大小：</h4>
<h4>https://www.zfanw.com/blog/gruntjs-optimize-image-size-loseless.html</h4>
<h4>前端js和css的压缩合并之grunt：</h4>
<h4>http://www.haorooms.com/post/qd_grunt_cssjs</h4>
<h4>grunt官网：</h4>
<h4>http://gruntjs.com/getting-started</h4>

            </div>
        </div>
        </div>
        </div>
    </body>

</html>
